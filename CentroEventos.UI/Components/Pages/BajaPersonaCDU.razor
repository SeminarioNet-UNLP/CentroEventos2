@inject BajaPersonaUseCase bajaPersona
@inject ISesion sesion
@inject ServicioAutorizacion permisos
@inject IServicioAutorizacion autorizacion

@if(AlertError)
{
    <div>
        <Alert Color="AlertColor.Danger"> @errorMessage </Alert>
    </div>
}

@if(AlertSucces)
{
    <div>
        <Alert Color="AlertColor.Success"> Se ha borrado con exito!</Alert>
    </div>
}


@code {
    [Parameter]
    public int idPersona {get; set;}
    private bool AlertError = false;
    private bool AlertSucces = false;
    string? errorMessage = null;

    private void Eliminar()
    {   
        Usuario? usu = sesion.ObtenerUsuarioActivo();

       if(usu != null && autorizacion.PoseeElPermiso(usu, Permiso.Administrador))
        {
            try
            {
               bajaPersona.Ejecutar(idPersona, usu);
               AlertSucces = true;
            }
            catch(Exception ex)
            {   
                AlertError=true;
                errorMessage = $"Error: {ex}";
            }
        }

    }
    
}    